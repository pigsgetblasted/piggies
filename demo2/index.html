<html data-wf-domain="arturs-supercool-site-0768f6.webflow.io" data-wf-page="65cc2e9d0877c06745d0d8a1" data-wf-site="65cc2e9d0877c06745d0d89a" class=" w-mod-js">
    <head>
        <style>.wf-force-outline-none[tabindex="-1"]:focus{outline:none;}</style>
        <meta charset="utf-8"><title>PIGS GET BLASTED</title>
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <meta content="Webflow" name="generator">
        <link href="css/app.css" rel="stylesheet" type="text/css">
        <link href="css/custom.css" rel="stylesheet" type="text/css">
        <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
        <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
        <link rel="manifest" href="../site.webmanifest">
    </head>
    
    <body class="body">
        <div data-animation="over-right" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav">
            <div class="navigation-container w-container">
                <a href="#" class="w-nav-brand">
                    <img src="images/Logo.png" loading="lazy" alt="" class="full-image">
                </a>
                <nav role="navigation" class="nav-menu w-nav-menu">
                    <a href="#" class="nav-link w-inline-block">
                        <div class="menu-image">
                            <img src="images/x.png" loading="lazy" alt="">
                        </div>
                        <div class="nav-text">Twitter</div>
                    </a>
                    <a href="#" class="nav-link w-inline-block">
                        <div class="menu-image">
                            <img src="images/discord.png" loading="lazy" alt="">
                        </div>
                        <div class="nav-text">Discord</div>
                    </a>
                    <a href="#" class="nav-link w-inline-block">
                        <div class="menu-image">
                            <img src="images/rules.png" loading="lazy" alt="">
                        </div>
                        <div class="nav-text">Rules</div>
                    </a>
                    
                </nav>

                <div class="w-nav-connect">
                    <a href="#" id="connect-wallet" class="nav-action">Connect Wallet</a>
                </div>                

                <div class="w-nav-button" style="-webkit-user-select: text;" aria-label="menu" role="button" tabindex="0" aria-controls="w-nav-overlay-0" aria-haspopup="menu" aria-expanded="false">
                    <div class="w-icon-nav-menu"></div>
                </div>
            </div>
            <div class="w-nav-overlay" data-wf-ignore="" id="w-nav-overlay-0"></div>
        </div>
        
        <!-- Section1 -->
        <section class="section" id="section1">
            <div class="container">
                <div class="flex align-center">
                    <div class="flex-left-item">
                        <h1 class="heading">PIGS<span class="yellow">.</span><br>GET<span class="yellow">.</span><br>BLASTED<span class="yellow">.</span></h1>
                    </div>
                    <div class="flex-right-item">
                        <div class="image-box">
                            <img src="images/pig.png" loading="lazy" alt="" class="full-image">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section2 -->
        <section class="section" id="section2">
            <div class="heading-box center">
                <div class="container short">
                    <h2 class="section__heading">Mint <span class="yellow">Piggybombs.</span> </h2>
                    <div class="section__subheading">Reminder: All ETH is <span class="yellow">refunded</span> after exploding <span class="yellow">your PIGGYBOMB.</span></div>
                </div>
            </div>
            <div class="content-box dots">
                <div class="container short">
                    <div class="grid">
                        <div id="w-node-_5739cb7f-a43b-dcfa-91b4-069deeac0123-45d0d8a1" class="mint-item-box">
                            <div class="image-box">
                                <img src="images/pig2.png" loading="lazy" alt="" class="full-image">

                                <div class="mint-qty">
                                    <div class="mint-qty-input">
                                        <button class="minus-btn">
                                            <img src="images/minus.png" alt="" />                                            
                                        </button>
                                        <input type="number" id="quantity-small" name="qty" value="1" min="1" step="1" />
                                        <button class="plus-btn">
                                            <img src="images/plus.png" alt="" />                                            
                                        </button>
                                    </div>
                                    <div class="mint-label">Low Power <span>-0.03</span></div>
                                </div>
                            </div>
                            <div class="action-box">
                                <a href="#" id="mint-small" class="mint-button">Mint</a>
                            </div>
                        </div>
                        <div id="w-node-bb9a5d7b-15f4-957c-3a3b-91c0f19ca624-45d0d8a1" class="mint-item-box">
                            <div class="image-box">
                                <img src="images/pig_mid.webp" loading="lazy" alt="" class="full-image">
                                <div class="mint-qty">
                                    <div class="mint-qty-input">
                                        <button class="minus-btn">
                                            <img src="images/minus.png" alt="" />                                            
                                        </button>
                                        <input type="number" id="quantity-medium" name="qty" value="1" min="1" step="1" />
                                        <button class="plus-btn">
                                            <img src="images/plus.png" alt="" />                                            
                                        </button>
                                    </div>
                                    <div class="mint-label">Mid Power <span>-0.10</span></div>
                                </div>
                            </div>
                            <div class="action-box">
                                <a href="#" id="mint-medium" class="mint-button">Mint</a>
                            </div>
                        </div>
                        <div id="w-node-_185001ba-e326-5b73-9fd4-748cd6860a10-45d0d8a1" class="mint-item-box">
                            <div class="image-box">
                                <img src="images/pig_big.webp" loading="lazy" alt="" class="full-image">
                                <div class="mint-qty">
                                    <div class="mint-qty-input">
                                        <button class="minus-btn">
                                            <img src="images/minus.png" alt="" />                                            
                                        </button>
                                        <input type="number" id="quantity-large" name="qty" value="1" min="1" step="1" />
                                        <button class="plus-btn">
                                            <img src="images/plus.png" alt="" />                                            
                                        </button>
                                    </div>
                                    <div class="mint-label">Big Power <span>-0.25</span></div>
                                </div>
                            </div>
                            <div class="action-box">
                                <a href="#" id="mint-large" class="mint-button">Mint</a>
                            </div>
                        </div>
                        <div id="w-node-a79ca671-e8d0-236e-0b39-66e7af5934d1-45d0d8a1" class="mint-item-box">
                            <div class="image-box">
                                <img src="images/pig_nuke.webp" loading="lazy" alt="" class="full-image">
                                <div class="mint-qty">
                                    <div class="mint-qty-input">
                                        <button class="minus-btn">
                                            <img src="images/minus.png" alt="" />                                            
                                        </button>
                                        <input type="number" id="quantity-nuclear" name="qty" value="1" min="1" max="1" step="1" />
                                        <button class="plus-btn">
                                            <img src="images/plus.png" alt="" />                                            
                                        </button>
                                    </div>
                                    <div class="mint-label">Nuke Power <span>-0.10</span></div>
                                </div>
                            </div>
                            <div class="action-box">
                                <a href="#" id="mint-nuclear" class="mint-button">Mint</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section3 -->
        <section id="my-piggybombs-container" class="section">
            <div class="container">
                <div class="section-overlay">
                    <div class="heading-box center">
                        <h2 class="section__heading">My <span class="yellow">Piggybombs.</span></h2>
                        <div class="section__subheading">Unexploded Bombs. <span class="yellow">Click to explode.</span></div>
                    </div>
                    <div class="content-box">
                        <div id="my-piggybombs" class="flex">
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig2.png" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Low</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/12/24</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig2.png" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Low</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/12/24</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig2.png" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Low</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/12/24</div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig2.png" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Low</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/12/24</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig_mid.webp" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Mid</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/15/24</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig_mid.webp" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Mid</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/15/24</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig2.png" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Mid</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 03/18/24</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig_nuke.webp" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Nuclear</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 04/12/24</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-item">
                                <div class="mint-item-box">
                                    <div class="image-box">
                                        <img src="images/pig_big.webp" loading="lazy" alt="" class="full-image">
                                        <div class="mint-label">Power: Big</div>
                                    </div>
                                    <div class="action-box">
                                        <div class="mint-text">Mint Date: 04/15/24</div>
                                    </div>
                                </div>
                            </div>                            
                        </div>
                        <div class="title-box">
                            <h3 class="heading__medium left">Game <span class="yellow">Status:</span> Active</h3>
                            <h3 class="heading__medium right">Game <span class="yellow">Clock:</span> 90D 0H 0M</h3>
                        </div>
    
                        <div class="flex-box"></div>
                    </div>

                    <div class="image-box" id="image-box1"><img src="images/frame2.png" alt="" /></div>
                    <div class="image-box" id="image-box2"><img src="images/frame1.png" alt="" /></div>                    
                    <div class="image-box" id="image-box3"><img src="images/horizontal-dots.png" alt="" /></div>
                </div>
            </div>
        </section>

        <!-- Section4 -->
        <section id="my-exploded-container" class="section">
            <div class="container">
                <div class="heading-box center">
                    <div class="container short">
                        <h2 class="section__heading">My <span class="yellow">Exploded</span> Bombs.</span></h2>
                        <div class="section__subheading">Reminder: All ETH is <span class="yellow">refunded</span> after exploding <span class="yellow">your PIGGYBOMB.</span></div>
                    </div>
                </div>
                <div class="content-box">
                    <div class="pigs-box">
                        <div id="my-exploded" class="pigs-box-wrapper">
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                    <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                  <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                     <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                 <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                   <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                 <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                    <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                     <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                   <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                   <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                   <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                 <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                              <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                  <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                               <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>
                            <div class="pig-item">
                                <div class="pig-image"><img src="images/smallPig.png" alt="" /></div>
                                     <div  class="pig-text">
                                    <p>Power: Low</p>
                                    <p>Exploded Date:</p>
                                    <p>03/15/24</p>
                                    <p>At 11:23 pm</p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section5 -->
        <section class="section" id="section5">
            <div class="container">
                <div class="heading-box center">
                    <h2 class="section__heading">Community <span class="yellow">Explosions.</span></h2>
                </div>
                <div class="content-box">
                    <div class="heading-grid">
                        <div class="grid-image"><img src="images/VerticalLine.png" alt="" /></div>
                        <div class="heading-grid-left-item">
                            <h3 class="section__subheading1">Exploded<br/><span class="yellow">Bombs:</span></h3>
                            <div id="burned" class="section__number">-1</div>
                            <p class="section__paragraph">(18 nuclear,<br>325 large,<br>15 medium,<br>8 small)</p>
                        </div>
                        <div class="heading-grid-right-item">
                            <h3 class="section__subheading1">Unexploded<br/><span class="yellow">Bombs:</span></h3>
                            <div id="total-supply" class="section__number">-1</div>
                            <p class="section__paragraph">(58 nuclear,<br>900 large,<br>11 medium,<br>200 small)</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section6 -->
        <section class="section" id="section6">
            <div class="container">
                <div class="history-box">
                    <div class="history-box-wrapper">
                        <div class="history-line-box"><div class="history-line"></div></div>
                        
                        <div class="history-item">
                            <h3>March 1</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div>
        
                        <div class="history-item">
                            <h3>March 2</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div>
        
                        <div class="history-item">
                            <h3>March 3</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div>
                        <div class="history-item">
                            <h3>March 4</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div>
        
                        <div class="history-item">
                            <h3>March 5</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div>
        
                        <div class="history-item">
                            <h3>March 6</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div>      
                        
                        <div class="history-item">
                            <h3>March 7</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div> 

                        <div class="history-item">
                            <h3>March 8</h3>
                            <h4>15 explosions</h4>
                            <p>(58 nuclear, 900 large, 12 medium, 2000 small)</p>
                        </div> 
                    </div>
                </div>


            </div>
        </section>

        <!-- Section7 -->
        <section class="section" id="section7">
            <div class="container">
                <h2 class="heading__medium">Bulls and bears make money<span class="yellow">,</span><br><span class="yellow">pigs get blasted</span>.</h2>
            </div>
        </section>

        <!-- Footer -->
        <section class="footer"><div class="container"><div class="footer-text">Pigs get blasted. 2024.</div></div></section>


        <script src="js/jquery.min.js" type="text/javascript"></script>
        <script src="js/jquery.dragscroll.min.js" type="text/javascript"></script>
        <script src="js/app.js" type="text/javascript"></script>
        <script src="js/custom.js" type="text/javascript"></script>
        
        <!-- <script type="text/javascript" src="https://unpkg.com/web3@1.6.0/dist/web3.min.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.10.4/web3.min.js" integrity="sha512-jrrqoRbH3+TZhsm54CVfS3hsIPDC2lYTXFBTJ5AkjRzcxtdlXxpSpYj0HGoN8DNkMD4zq1IjJpWBHI5KPGUYhg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- <script type="text/javascript" src="https://unpkg.com/web3modal@1.9.4/dist/index.js"></script> -->
        <!-- <script type="text/javascript" src="https://unpkg.com/@walletconnect/web3-provider@1.7.0/dist/umd/index.min.js"></script> -->
        <!-- <script type="text/javascript" src="/js/walletlink.bundle.js"></script> -->

        <script src="https://cdn.jsdelivr.net/npm/keccak256@1.0.6/keccak256.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/merkletreejs@0.3.11/merkletree.js"></script>
        <script type="text/javascript" src="/demo2/js/merkle.js"></script>
        <script type="text/javascript" src="/demo2/js/eth-session.js"></script>
<script>
const epoch = 2177302;
const powerMap = {
  1: 'Nuclear',
  2: 'Big',
  3: 'Mid',
  4: 'Low',
};

let config = {
  burned: -1,
  feePercent: BigInt(5),
  saleState: 0,
  totalSupply: -1,
  prices: {
    1: BigInt('100000000000000'),
    2: BigInt('250000000000000'),
    3: BigInt('100000000000000'),
    4: BigInt( '30000000000000')
  }
};

const merkle = new Merkle();
merkle.load([


]);

const session = new EthereumSession({
	chain:           EthereumSession.COMMON_CHAINS[168587773],
	contractAddress: '0x9558EB5FFc6235220D26dB35dACCd41072D7Ce20',
	contractABI:     [{"inputs":[{"internalType":"address","name":"_pointsContract","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"AddressInsufficientBalance","type":"error"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"address","name":"owner","type":"address"}],"name":"ERC721IncorrectOwner","type":"error"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ERC721InsufficientApproval","type":"error"},{"inputs":[{"internalType":"address","name":"approver","type":"address"}],"name":"ERC721InvalidApprover","type":"error"},{"inputs":[{"internalType":"address","name":"operator","type":"address"}],"name":"ERC721InvalidOperator","type":"error"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"ERC721InvalidOwner","type":"error"},{"inputs":[{"internalType":"address","name":"receiver","type":"address"}],"name":"ERC721InvalidReceiver","type":"error"},{"inputs":[{"internalType":"address","name":"sender","type":"address"}],"name":"ERC721InvalidSender","type":"error"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ERC721NonexistentToken","type":"error"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"index","type":"uint256"}],"name":"ERC721OutOfBoundsIndex","type":"error"},{"inputs":[],"name":"FailedInnerCall","type":"error"},{"inputs":[],"name":"InvalidPayment","type":"error"},{"inputs":[],"name":"InvalidPriceCount","type":"error"},{"inputs":[],"name":"NoBalance","type":"error"},{"inputs":[],"name":"NotAContract","type":"error"},{"inputs":[],"name":"NotAuthorized","type":"error"},{"inputs":[],"name":"NotEOA","type":"error"},{"inputs":[],"name":"OrderExceedsAllowance","type":"error"},{"inputs":[],"name":"OrderExceedsSupply","type":"error"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"OwnableInvalidOwner","type":"error"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"OwnableUnauthorizedAccount","type":"error"},{"inputs":[],"name":"PaymentFailed","type":"error"},{"inputs":[{"internalType":"uint8","name":"","type":"uint8"}],"name":"SalesClosed","type":"error"},{"inputs":[],"name":"UnauthorizedDelegate","type":"error"},{"inputs":[{"internalType":"uint8","name":"","type":"uint8"}],"name":"UnsupportedTokenType","type":"error"},{"inputs":[{"internalType":"bytes","name":"","type":"bytes"}],"name":"WithdrawError","type":"error"},{"anonymous":false,"inputs":[{"internalType":"address","name":"owner","type":"address","indexed":true},{"internalType":"address","name":"approved","type":"address","indexed":true},{"internalType":"uint256","name":"tokenId","type":"uint256","indexed":true}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"internalType":"address","name":"owner","type":"address","indexed":true},{"internalType":"address","name":"operator","type":"address","indexed":true},{"internalType":"bool","name":"approved","type":"bool","indexed":false}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"internalType":"address","name":"from","type":"address","indexed":true},{"internalType":"uint16","name":"tokenId","type":"uint16","indexed":true},{"internalType":"uint8","name":"tokenType","type":"uint8","indexed":true},{"internalType":"uint32","name":"burnTS","type":"uint32","indexed":false},{"internalType":"uint32","name":"duration","type":"uint32","indexed":false}],"name":"Blast","type":"event"},{"anonymous":false,"inputs":[{"internalType":"address","name":"previousOwner","type":"address","indexed":true},{"internalType":"address","name":"newOwner","type":"address","indexed":true}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"internalType":"address","name":"from","type":"address","indexed":true},{"internalType":"address","name":"to","type":"address","indexed":true},{"internalType":"uint256","name":"tokenId","type":"uint256","indexed":true}],"name":"Transfer","type":"event"},{"name":"BLAST","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"address","name":"","type":"address"}]},{"name":"BLAST_POINTS","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"address","name":"","type":"address"}]},{"name":"MAX_NUKES","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint16","name":"","type":"uint16"}]},{"name":"approve","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"outputs":[]},{"name":"balanceOf","stateMutability":"view","type":"function","inputs":[{"internalType":"address","name":"owner","type":"address"}],"outputs":[{"internalType":"uint256","name":"balance","type":"uint256"}]},{"name":"burn","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"uint16[]","name":"tokenIds","type":"uint16[]"}],"outputs":[]},{"name":"burned","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"feePercent","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint16","name":"","type":"uint16"}]},{"name":"getApproved","stateMutability":"view","type":"function","inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"outputs":[{"internalType":"address","name":"approver","type":"address"}]},{"name":"getClaimableETH","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"getClaimableGas","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"getConfig","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"tuple","name":"","type":"tuple","components":[{"internalType":"uint256","name":"burned","type":"uint256"},{"internalType":"uint16","name":"feePercent","type":"uint16"},{"internalType":"uint8","name":"saleState","type":"uint8"},{"internalType":"uint256","name":"totalSupply","type":"uint256"},{"internalType":"uint256[]","name":"prices","type":"uint256[]"}]}]},{"name":"isApprovedForAll","stateMutability":"view","type":"function","inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"outputs":[{"internalType":"bool","name":"isApproved","type":"bool"}]},{"name":"isDelegate","stateMutability":"view","type":"function","inputs":[{"internalType":"address","name":"addr","type":"address"}],"outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"name":"merkleRootPrimary","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"name":"merkleRootSecondary","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"name":"mint","stateMutability":"payable","type":"function","inputs":[{"internalType":"uint16","name":"quantity","type":"uint16"},{"internalType":"uint8","name":"tokenType","type":"uint8"},{"internalType":"bytes32[]","name":"proof","type":"bytes32[]"}],"outputs":[]},{"name":"name","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"string","name":"name_","type":"string"}]},{"name":"nextNuke","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint16","name":"","type":"uint16"}]},{"name":"nukeLimit","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint16","name":"","type":"uint16"}]},{"name":"owner","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"address","name":"","type":"address"}]},{"name":"ownerOf","stateMutability":"view","type":"function","inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"outputs":[{"internalType":"address","name":"owner","type":"address"}]},{"name":"owners","stateMutability":"view","type":"function","inputs":[{"internalType":"address","name":"","type":"address"}],"outputs":[{"internalType":"uint16","name":"balance","type":"uint16"},{"internalType":"uint16","name":"burned","type":"uint16"},{"internalType":"uint16","name":"nuclear","type":"uint16"}]},{"name":"prices","stateMutability":"view","type":"function","inputs":[{"internalType":"uint8","name":"","type":"uint8"}],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"range","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint16","name":"lower","type":"uint16"},{"internalType":"uint16","name":"current","type":"uint16"},{"internalType":"uint16","name":"upper","type":"uint16"},{"internalType":"uint16","name":"minted","type":"uint16"}]},{"name":"renounceOwnership","stateMutability":"nonpayable","type":"function","inputs":[],"outputs":[]},{"name":"safeTransferFrom","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"outputs":[]},{"name":"safeTransferFrom","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"outputs":[]},{"name":"saleState","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint8","name":"","type":"uint8"}]},{"name":"setApprovalForAll","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"outputs":[]},{"name":"setBlastPointsConfig","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"_contract","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"outputs":[]},{"name":"setDelegate","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"bool","name":"isDelegate_","type":"bool"}],"outputs":[]},{"name":"setFeePercent","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"uint16","name":"_pct","type":"uint16"}],"outputs":[]},{"name":"setMerkleRoot","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"bytes32","name":"merkleRoot","type":"bytes32"}],"outputs":[]},{"name":"setNuclearLimit","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"uint16","name":"limit","type":"uint16"}],"outputs":[]},{"name":"setPrices","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"uint256[]","name":"newPrices","type":"uint256[]"}],"outputs":[]},{"name":"setSaleState","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"uint8","name":"newState","type":"uint8"}],"outputs":[]},{"name":"setTokenURI","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"string","name":"prefix","type":"string"},{"internalType":"string","name":"suffix","type":"string"}],"outputs":[]},{"name":"supportsInterface","stateMutability":"view","type":"function","inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"name":"symbol","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"string","name":"symbol_","type":"string"}]},{"name":"tokenByIndex","stateMutability":"view","type":"function","inputs":[{"internalType":"uint256","name":"index","type":"uint256"}],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"tokenOfOwnerByIndex","stateMutability":"view","type":"function","inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"index","type":"uint256"}],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"tokenURI","stateMutability":"view","type":"function","inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"outputs":[{"internalType":"string","name":"","type":"string"}]},{"name":"tokenURIPrefix","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"string","name":"","type":"string"}]},{"name":"tokenURISuffix","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"string","name":"","type":"string"}]},{"name":"tokens","stateMutability":"view","type":"function","inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"outputs":[{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint32","name":"mintTS","type":"uint32"},{"internalType":"uint32","name":"burnTS","type":"uint32"},{"internalType":"uint8","name":"tokenType","type":"uint8"}]},{"name":"totalFees","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"totalSupply","stateMutability":"view","type":"function","inputs":[],"outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"name":"transferFrom","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"outputs":[]},{"name":"transferOwnership","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"outputs":[]},{"name":"updateMerkleRoot","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"bytes32","name":"merkleRoot","type":"bytes32"}],"outputs":[]},{"name":"withdrawETH","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"to","type":"address"}],"outputs":[]},{"name":"withdrawFees","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"to","type":"address"}],"outputs":[]},{"name":"withdrawGas","stateMutability":"nonpayable","type":"function","inputs":[{"internalType":"address","name":"to","type":"address"}],"outputs":[]}]
});

const abbrev = ( account ) => {
	return account.substring( 0, 6 ) +'...'+ account.substring( account.length - 4 );
}

const formatToken = (token, tokenId) => ({
  tokenId,
  burnTS: parseInt(token.burnTS, 10),
  mintTS: parseInt(token.mintTS, 10),
  owner: token.owner,
  tokenType: parseInt(token.tokenType, 10),
  value: BigInt(token.value)
});

const getAccountTokens = async (currentAccount) => {
  const promises = [];
  const balance = await session.getContract().methods.balanceOf(currentAccount).call();
  for (let i = 0; i < balance; ++i){
    const idx = i;
    const p = threeTry(() => session.getContract().methods.tokenOfOwnerByIndex(currentAccount, idx).call());
    promises.push(p);
  }
  
  const exploded = [];
  const tokenIds = await Promise.all(promises);

/*
  const fullAccount = Web3.utils.padLeft(currentAccount, 64).toLowerCase();
  const fullZero = Web3.utils.padLeft('0x00', 64);
  const toLogs = await session.web3client.eth.getPastLogs({
    fromBlock: epoch,
    // toBlock: "latest",
    address: session.contractAddress,
    topics: [
      "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
      null,       // From
      fullAccount // To
    ]
  });

  if (!toLogs.length)
    return [];


  const fromLogs = await session.web3client.eth.getPastLogs({
    fromBlock: epoch,
    // toBlock: "latest",
    address: session.contractAddress,
    topics: [
      "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef", // Transfer
      fullAccount // From
    ]
  });

  
  const allLogs = fromLogs.length ?
    [...toLogs, ...fromLogs] :
    toLogs;

  allLogs.sort((left, right) => {
    let res = left.blockNumber - right.blockNumber;
    if (res !== 0)
      return res;
      
    res = left.transactionIndex - right.transactionIndex;
    if (res !== 0)
      return res;

    return left.logIndex - right.logIndex;
  });

  const explodedIds = [];
  const tokenSet = new Set();
  for (let log of allLogs) {
    if (log.topics[2].toLowerCase() === fullAccount) {
      tokenSet.add(BigInt(log.topics[3]));
    }
    else{
      tokenSet.remove(BigInt(log.topics[3]));

      if (log.topics[2].toLowerCase() === fullZero) {
        explodedIds.push(BigInt(log.topics[3]));
      }      
    }
  }


  // let tokens = await session.getContract().methods.getTokens(tokenIds).call();
  let exploded = await Promise.all(
    explodedIds.map(tokenId => {
      return threeTry(() => session.getContract().methods.tokens(tokenId).call());
    })
  );
  exploded = exploded.map((e, idx) => {
    return formatToken(e, explodedIds[idx])
  });
  

  // let tokens = await session.getContract().methods.getTokens(tokenIds).call();
  const tokenIds = Array.from(tokenSet);
  */
  let tokens = await Promise.all(
    tokenIds.map(tokenId => {
      return threeTry(() => session.getContract().methods.tokens(tokenId).call());
    })
  );
  tokens = tokens.map((t, idx) => {
    return formatToken(t, tokenIds[idx]);
  });

  return {exploded, tokens};
};

const handleConnect = async (evt, deep) => {
	if (evt?.cancelable)
		evt?.preventDefault();

	// if (deep) {
	// 	try{
	// 		this.provider = await modal.connect();
	// 	}
	// 	catch (e) {
	// 		console.warn({e});
	// 		if( e && e !== 'Modal closed by user' )
	// 			alert( "Connection failed, please try again" );
  // 
	// 		return false;
	// 	}
	// }

	if (await session.connectWeb3(deep)) {
		handleConnected();
		return true;
	}
	else{
		return false;
	}
}

// TODO: refresh
const handleConnected = async () => {
	const allAccounts = await session.getWalletAccounts();
  if (!allAccounts?.length)
    return;


  const currentAccount = allAccounts[0];
	document.getElementById('connect-wallet').innerText = abbrev(currentAccount);

  const tmpConfig = await session.getContract().methods.getConfig().call();
  config.burned = tmpConfig.burned;
  config.feePercent = BigInt(tmpConfig.feePercent);
  config.saleState = tmpConfig.saleState;
  config.totalSupply = tmpConfig.totalSupply;
  config.prices[1] = BigInt(tmpConfig.prices[1]);
  config.prices[2] = BigInt(tmpConfig.prices[2]);
  config.prices[3] = BigInt(tmpConfig.prices[3]);
  config.prices[4] = BigInt(tmpConfig.prices[4]);

  document.getElementById('burned').innerText = config.burned;
  document.getElementById('total-supply').innerText = config.totalSupply;

  const {exploded, tokens} = await getAccountTokens(currentAccount);
  renderTokens(tokens);
  renderExploded(exploded);
};

const handleInit = async () => {
	try{
		await handleConnect();
	}
	catch(err){
		console.warn({ err });
	}
};

const handleMintSmall = async () => {
  const quantity = document.getElementById('quantity-small').value;
  handleMint(quantity, 4);
};

const handleMintMedium = async () => {
  const quantity = document.getElementById('quantity-medium').value;
  handleMint(quantity, 3);
};

const handleMintLarge = async () => {
  const quantity = document.getElementById('quantity-large').value;
  handleMint(quantity, 2);
};

const handleMintNuclear = async () => {
  const quantity = document.getElementById('quantity-nuclear').value;
  handleMint(quantity, 1);
};

const handleMint = async (quantity, tokenType) => {
  try {
    const tmpQuantity = parseInt(quantity, 10);
    if (Number.isNaN(tmpQuantity)) {
      console.warn(`Invalid quantity: ${quantity}`);
      return;
    }

    if (tmpQuantity === 0) {
      alert('Please enter a quantity');
      console.warn(`Invalid quantity: ${quantity}`);
      return;
    }


    let currentAccount;
    if (await handleConnect(null, true)) {
    	const allAccounts = await session.getWalletAccounts();
      if (!allAccounts?.length) {
        alert('Please connect your wallet');
        return;      
      }
      
      currentAccount = allAccounts[0];
    }
    else{
      alert('Please connect your wallet');
      return;
    }


    let proof = [];
    const saleState = await session.getContract().methods.saleState().call()
      .then(saleState => parseInt(saleState, 10));
    if (tokenType === 1) {
      if ((saleState & 1) !== 1) {
        alert('Nuclear sales are closed');
        return;
      }

      proof = merkle.getProof(currentAccount);
      if (!proof.length) {
        alert(`The selected wallet ${abbrev(currentAccount)} is not authorized`);
        return;
      }
    }
    else if (2 <= tokenType && tokenType <= 4) {
      if ((saleState & 2) !== 2) {
        alert('Public sales are closed');
        return;
      }
    }
    else{
      // invalid tokenType
      console.warn(`Invalid token type: ${tokenType}`);
      return;
    }

    const feeNumerator = BigInt(100) + config.feePercent;
    const feeDenominator = BigInt(100);
    const priceEach = config.prices[tokenType];
    const totalValue = BigInt(quantity) * priceEach;
    const totalValueWithFees = totalValue * feeNumerator / feeDenominator;
    const gasLimit = await session.getContract().methods.mint(quantity, tokenType, proof).estimateGas({
      from: currentAccount,
      value: String(totalValueWithFees)
    });

    const txn = await session.getContract().methods.mint(quantity, tokenType, proof).send({
      from: currentAccount,
      gas: gasLimit,
      value: String(totalValueWithFees)
    });

    alert("Congratulations! Mint successful, get ready to explode some piggies.");
    handleConnected();
  }
  catch (err) {
    if (err.code === -32000) {
      alert("Not enough ETH");
      return;
    }

    const error = EthereumSession.getError(err);
    if (error.data) {
      const selector = error.data.substring(0, 10);
      const abi = session.errors[selector];
      if(abi){
        if(abi.inputs?.length){
          const args = error.data.substring(10);
          const decoded = session.web3client.eth.abi.decodeParameters(abi.inputs, args);

          const params = [];
          for(let i = 0; i < abi.inputs.length; ++i){
            params.push(decoded[i]);
          }
          error.message = abi.name +'('+ params.join(', ') +')';
        }
        else{
          error.message = abi.name;
        }
        
        if (error.message.startsWith("SalesClosed")) {
          error.message = "Sales are closed";
        }
      }
    }

    console.error(error);
    alert(error.message);
  }
};

const handleTokenBurn = async (evt, token) => {
  try {
    if (evt?.cancelable)
      evt?.preventDefault();

    let currentAccount;
    if (await handleConnect(null, true)) {
    	const allAccounts = await session.getWalletAccounts();
      if (!allAccounts?.length) {
        alert('Please connect your wallet');
        return;      
      }

      currentAccount = allAccounts[0];
    }
    else{
      alert('Please connect your wallet');
      return;
    }


    const gasLimit = await session.getContract().methods.burn([token.tokenId]).estimateGas({
      from: currentAccount,
    });

    const txn = await session.getContract().methods.burn([token.tokenId]).send({
      from: currentAccount,
      gas: gasLimit
    });

    alert("BOOM! Burn successful!");
    handleConnected();
  }
  catch (err) {
    if (err.code === -32000) {
      alert("Not enough ETH");
      return;
    }

    const error = EthereumSession.getError(err);
    if (error.data) {
      const selector = error.data.substring(0, 10);
      const abi = session.errors[selector];
      if(abi){
        if(abi.inputs?.length){
          const args = error.data.substring(10);
          const decoded = session.web3client.eth.abi.decodeParameters(abi.inputs, args);

          const params = [];
          for(let i = 0; i < abi.inputs.length; ++i){
            params.push(decoded[i]);
          }
          error.message = abi.name +'('+ params.join(', ') +')';
        }
        else{
          error.message = abi.name;
        }
        
        if (error.message.startsWith("SalesClosed")) {
          error.message = "Sales are closed";
        }
      }
    }

    console.error(error);
    alert(error.message);
  }
};

const renderExploded = (exploded) => {
  const myExploded = document.getElementById('my-exploded');
  if (exploded.length) {
    myExploded.innerHTML = '';

    for (const token of exploded) {
      const el = renderToken(token);
      myExploded.appendChild(el);
    }
  }
  else{
    myExploded.innerHTML = "It's almost time for makin' bacon!";
  }
};

const renderTokens = (tokens) => {
  const myPiggyBombs = document.getElementById('my-piggybombs');
  if (tokens.length) {
    myPiggyBombs.innerHTML = '';

    for (const token of tokens) {
      const el = renderToken(token, true);
      myPiggyBombs.appendChild(el);
    }
  }
  else{
    myPiggyBombs.innerHTML = "Get more piggies!";
  }
};

const threeTry = (callback) => {
  return new Promise(async (resolve, reject) => {
    let lastError;
    for(let i = 0; i < 3; ++i) {
      try{
        const result = await callback();
        resolve(result);
        return;
      }
      catch(err) {
        lastError = err;
      }
    }
    
    reject(lastError);
  });
};

const renderToken = (token, canBurn) => {
  const date = new Date(token.mintTS * 1000);
  const power = powerMap[token.tokenType];
  const innerHTML = `
      <div class="mint-item-box">
          <div class="image-box">
              <img src="images/pig2.png" loading="lazy" alt="" class="full-image">
              <div class="mint-label">Power: ${power}</div>
          </div>
          <div class="action-box">
              <div class="mint-text">Mint Date: ${date.toLocaleDateString()}</div>
          </div>
      </div>`;
  
  const el = document.createElement('div');
  el.innerHTML = innerHTML;
  el.classList.add('flex-item');
  
  if (canBurn) {
    el.style.cursor = 'pointer';
    el.addEventListener('click', (evt) => handleTokenBurn(evt, token));
  }

  return el;
};

document.addEventListener('DOMContentLoaded', async () => {
  document.getElementById('connect-wallet')?.addEventListener('click', (evt) => handleConnect(evt, true));
  document.getElementById('mint-small')?.addEventListener('click',   handleMintSmall);
  document.getElementById('mint-medium')?.addEventListener('click',  handleMintMedium);
  document.getElementById('mint-large')?.addEventListener('click',   handleMintLarge);
  document.getElementById('mint-nuclear')?.addEventListener('click', handleMintNuclear);

  handleInit();
});
</script>
    </body>
</html>
